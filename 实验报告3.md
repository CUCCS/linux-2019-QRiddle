# 实验三：SYSTEMD

## 实验要求

- [x] systemd录像上传
- [x] 自查清单

## 实验环境
- Ubuntu 18.04 Server 64bit
- asciinema

## 实验过程
### 命令篇
[systemd-命令篇](https://asciinema.org/a/XDC21sEnJiwaEtT90RJXEj1f7)

### 实战篇
[systemd-实战篇](https://asciinema.org/a/OGjRP70Mg1YYjmtdlgA0aAX2Y)

### 自查清单
- 如何添加一个用户并使其具备sudo执行程序的权限
```bash
# 添加用户
adduser newuser
# 加入sudo组
sudo adduser newuser sudo
```

- 如何将一个用户添加到一个用户组？
```bash
sudo adduser newuser 组名
```

- 如何查看当前系统的分区表和文件系统详细信息？
```bash
# 查看当前系统分区表
sudo fdist -l
# 查看文件系统详细信息
df-a
```

- 如何实现开机自动挂载Virtualbox的共享目录分区？
```bash
# 新建挂载目录
mkdir ~/shared
# 挂载文件夹
sudo mount -t vboxsf codes ~/shared
# 修改配置文件
sudo gedit /etc/fstab
# 修改模块
sudo gedit /etc/modules
```

- 基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？
```bash
# 逻辑卷信息
lvdisplay
# 缩容
lvreduce --size -1024m /dev/bogon-vg/root
# 扩容
lvextend --size +1024m /dev/bogon-vg/root
# 更改大小
lvresize --size +1024m /dev/bogon-vg/root
```
- 如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？
```bash
# 网络连通时运行脚本A，网络断开时运行脚本B
# 修改networking.service的设置文件以下的两个字段
ExecStartPost = A
ExecStopPost = B
```
- 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动？实现杀不死？
```bash
# 修改配置文件的Service区块的Request字段，将其值设为always
Restart：always
```

## 参考文献
[CUCCS/linux-2019-UP1998](https://github.com/CUCCS/linux-2019-UP1998/blob/linux_03/linux-3/linux-3.md)

[CUCCS/linux-2019-jckling](https://github.com/CUCCS/linux-2019-jckling/blob/0x03/0x03/实验报告.md)

[Systemd 入门教程：命令篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)

[Systemd 入门教程：实战篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)
